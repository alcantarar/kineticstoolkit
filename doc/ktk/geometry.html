<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.7.2" />
<title>ktk.geometry API documentation</title>
<meta name="description" content="Provides 3d geometry and linear algebra functions related to biomechanics â€¦" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{font-weight:bold}#index h4 + ul{margin-bottom:.6em}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>ktk.geometry</code></h1>
</header>
<section id="section-intro">
<p>Provides 3d geometry and linear algebra functions related to biomechanics.</p>
<p>This module contains functions related to 3D geometry and linear algebra
related to biomechanics.</p>
<p>The first dimension of every array is always N and corresponds to time. For
constants, use a length of 1 as the first dimension.</p>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="ktk.geometry.create_reference_frames"><code class="name flex">
<span>def <span class="ident">create_reference_frames</span></span>(<span>global_points, method='ocx1')</span>
</code></dt>
<dd>
<section class="desc"><p>Create a Nx4x4 series of reference frames based on a point cloud series.</p>
<p>Create reference frames based on global points, using the provided
method, and returns this series of reference frames as a series of
transformation matrices.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>global_points</code></strong> :&ensp;<code>array</code></dt>
<dd>A series of N sets of M points in a global reference frame (Nx4xM).</dd>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code> (optional)</dt>
<dd>
<p>The method to use to construct a reference frame based on these points.
Default is 'ocx1'.</p>
<p>Available values are:</p>
<ul>
<li>
<p>'ocx1' : An arbitraty system that is useful for marker clusters
(default).
Origin = Centroid of all points;
X is directed toward the first point;
Z is normal to the plane formed by the origin and both
first points;
Y is the vectorial product of X and Z.</p>
</li>
<li>
<p>'o1z2' : Reference frame based on lateral and anterior
vectors.
Origin = First point;
Z is directed toward the second point (right);
Y is normal to the plane formed by the three markers (up);
X is the vectorial product of Y and Z.</p>
</li>
<li>
<p>'isb-humerus' : Reference frame of the humerus as suggested by
the International Society of Biomechanics [1], when the elbow is
flexed by 90 degrees and the forearm is in complete pronation.
Origin = GH joint;
X is directed forward;
Y is directed upward;
Z is directed to the right;
Point 1 = GH joint;
Point 2 = Elbow center;
Point 3 = Ulnar styloid.</p>
</li>
<li>
<p>'isb-forarm' : Reference frame of the forearm as suggested by
the International Society of Biomechanics [1].
Origin = Ulnar Styloid;
X is directed forward in anatomic position;
Y is directed upward in anatomic position;
Z is directed to the right in anatomic position;
Point 1 = Ulnar Styloid;
Point 2 = Elbow center;
Point 3 = Radial styloid.</p>
</li>
</ul>
</dd>
</dl>
<p>[1] G. Wu et al., "ISB recommendation on definitions of joint
coordinate systems of various joints for the reporting of human joint
motion - Part II: shoulder, elbow, wrist and hand," Journal of
Biomechanics, vol. 38, no. 5, pp. 981&ndash;992, 2005.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>T</code></strong> :&ensp;<code>array</code></dt>
<dd>Series of transformation matrices (Nx4x4).</dd>
</dl></section>
</dd>
<dt id="ktk.geometry.create_rotation_matrices"><code class="name flex">
<span>def <span class="ident">create_rotation_matrices</span></span>(<span>axis, angles)</span>
</code></dt>
<dd>
<section class="desc"><p>Create a Nx4x4 series of rotation matrices around a given axis.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>axis</code></strong> :&ensp;<code>str</code></dt>
<dd>Can be either 'x', 'y' or 'z'.</dd>
<dt><strong><code>angle</code></strong> :&ensp;<code>array</code></dt>
<dd>Series of angles in radians.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>T</code></strong> :&ensp;<code>array</code></dt>
<dd>A Nx4x4 series of rotation matrices.</dd>
</dl></section>
</dd>
<dt id="ktk.geometry.get_global_coordinates"><code class="name flex">
<span>def <span class="ident">get_global_coordinates</span></span>(<span>local_coordinates, reference_frames)</span>
</code></dt>
<dd>
<section class="desc"><p>Express local coordinates in the global reference frame.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>local_coordinates</code></strong> :&ensp;<code>array</code></dt>
<dd>The local coordinates, as a series of N points, vectors or matrices.
For example:
- A series of N points or vectors : Nx4
- A series of N set of M points or vectors : Nx4xM
- A series of N 4x4 transformation matrices : Nx4x4</dd>
<dt><strong><code>reference_frames</code></strong> :&ensp;<code>array</code></dt>
<dd>A series of N reference frames (Nx4x4) the local coordinates are
expressed in.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>global_coordinates</code></strong> :&ensp;<code>array</code></dt>
<dd>Series of global coordinates in the same shape than <code>local_coordinates</code>.</dd>
</dl></section>
</dd>
<dt id="ktk.geometry.get_local_coordinates"><code class="name flex">
<span>def <span class="ident">get_local_coordinates</span></span>(<span>global_coordinates, reference_frames)</span>
</code></dt>
<dd>
<section class="desc"><p>Express global coordinates in local reference frames.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>global_coordinates</code></strong> :&ensp;<code>array</code></dt>
<dd>The global coordinates, as a series of N points, vectors or matrices.
For example:
- A series of N points or vectors : Nx4
- A series of N set of M points or vectors : Nx4xM
- A series of N 4x4 transformation matrices : Nx4x4</dd>
<dt><strong><code>reference_frames</code></strong> :&ensp;<code>array</code></dt>
<dd>A series of N reference frames (Nx4x4) to express the global
coordinates in.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>local_coordinates</code></strong> :&ensp;<code>array</code></dt>
<dd>Series of local coordinates in the same shape than
<code>global_coordinates</code>.</dd>
</dl></section>
</dd>
<dt id="ktk.geometry.isnan"><code class="name flex">
<span>def <span class="ident">isnan</span></span>(<span>input)</span>
</code></dt>
<dd>
<section class="desc"><p>Check which samples has at least one NaN.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>array</code></dt>
<dd>Array where the first dimension corresponds to time.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>output</code></strong> :&ensp;<code>array</code></dt>
<dd>Array of bool that is the same size of input's first dimension, with True
for the samples that contain at least one NaN.</dd>
</dl></section>
</dd>
<dt id="ktk.geometry.match_size"><code class="name flex">
<span>def <span class="ident">match_size</span></span>(<span>op1, op2)</span>
</code></dt>
<dd>
<section class="desc"><p>Match the first dimension of op1 and op2.</p>
<p>Broadcasts the first dimension of op1 or op2, if required, so that both
inputs have the same size in first dimension. If no modification is
required on an input, then the output is a reference to the same input.
Otherwise, the output is a new variable.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>op1</code></strong>, <strong><code>op2</code></strong> :&ensp;<code>arrays</code></dt>
<dd>Inputs, where the first dimension corresponds to time. If both
first dimensions are not already equal, at least one must be of length
1 so that it can be broadcasted.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>op1</code></strong>, <strong><code>op2</code></strong> :&ensp;<code>arrays</code></dt>
<dd>References or copies of op1 and op2 now matched in size.</dd>
</dl></section>
</dd>
<dt id="ktk.geometry.matmul"><code class="name flex">
<span>def <span class="ident">matmul</span></span>(<span>op1, op2)</span>
</code></dt>
<dd>
<section class="desc"><p>Matrix multiplication between series of matrices.</p>
<p>This function is a wrapper for numpy's matmul function (operator @), that
helps numpy to understand ktk's convention that the first dimension always
corresponds to time.</p>
<p>It aligns and create additionnal dimensions if needed to avoid dimension
mismatch errors.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>op1</code></strong>, <strong><code>op2</code></strong> :&ensp;<code>array</code></dt>
<dd>Series of floats, vectors or matrices.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>result</code></strong> :&ensp;<code>array</code></dt>
<dd>The product, as a series of Nx4 or Nx4xM matrices.</dd>
</dl></section>
</dd>
<dt id="ktk.geometry.register_points"><code class="name flex">
<span>def <span class="ident">register_points</span></span>(<span>global_points, local_points)</span>
</code></dt>
<dd>
<section class="desc"><p>Find the rigid transformations between two series of point clouds.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>global_points</code></strong> :&ensp;<code>array</code> of <code>shape</code> <code>Nx4xM</code></dt>
<dd>Destination points as a series of N sets of M points.</dd>
<dt><strong><code>local_points</code></strong> :&ensp;<code>array</code> of <code>shape</code> <code>Nx4xM</code></dt>
<dd>Local points as a series of N sets of M points.
global_points and local_points must have the same shape.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>T</code></strong> :&ensp;<code>array</code></dt>
<dd>Array of shape Nx4x4, expressing a series of 4x4 rigid transformation
matrices.</dd>
</dl></section>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="ktk" href="index.html">ktk</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="ktk.geometry.create_reference_frames" href="#ktk.geometry.create_reference_frames">create_reference_frames</a></code></li>
<li><code><a title="ktk.geometry.create_rotation_matrices" href="#ktk.geometry.create_rotation_matrices">create_rotation_matrices</a></code></li>
<li><code><a title="ktk.geometry.get_global_coordinates" href="#ktk.geometry.get_global_coordinates">get_global_coordinates</a></code></li>
<li><code><a title="ktk.geometry.get_local_coordinates" href="#ktk.geometry.get_local_coordinates">get_local_coordinates</a></code></li>
<li><code><a title="ktk.geometry.isnan" href="#ktk.geometry.isnan">isnan</a></code></li>
<li><code><a title="ktk.geometry.match_size" href="#ktk.geometry.match_size">match_size</a></code></li>
<li><code><a title="ktk.geometry.matmul" href="#ktk.geometry.matmul">matmul</a></code></li>
<li><code><a title="ktk.geometry.register_points" href="#ktk.geometry.register_points">register_points</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.7.2</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>